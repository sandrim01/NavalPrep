{% extends "base.html" %}

{% block title %}Academia Naval - Preparação Militar para Fuzileiros{% endblock %}

{% block meta_description %}Plataforma de preparação para concursos da Marinha do Brasil. Cursos completos para Cabo e Sargento com gamificação e professores especializados.{% endblock %}

{% block content %}
<!-- Main Content -->
<div class="main-content">
    <div class="content-wrapper">
        <!-- Hero Section -->
        <div class="row align-items-center mb-5">
            <div class="col-lg-8">
                <div class="hero-content fade-in">
                    <h1 class="display-5 fw-bold text-primary-custom mb-3">
                        <span class="text-accent-green">Academia Naval</span><br>
                        Preparação de Elite para Fuzileiros Navais
                    </h1>
                    <p class="lead text-secondary-custom mb-4">
                        Transforme sua carreira militar com nossa plataforma gamificada. 
                        Prepare-se para os concursos de Cabo e Sargento da Marinha com conteúdo 
                        de qualidade e metodologia comprovada.
                    </p>
                    
                    <div class="d-flex gap-3 mb-4">
                        {% if not current_user.is_authenticated %}
                        <a href="{{ url_for('auth.register') }}" class="btn btn-primary btn-lg">
                            <i class="fas fa-rocket me-2"></i>Iniciar Preparação
                        </a>
                        <a href="{{ url_for('main.courses') }}" class="btn btn-outline-light btn-lg">
                            <i class="fas fa-eye me-2"></i>Ver Cursos
                        </a>
                        {% else %}
                        <a href="{{ url_for('main.dashboard') }}" class="btn btn-primary btn-lg">
                            <i class="fas fa-tachometer-alt me-2"></i>Meu Dashboard
                        </a>
                        <a href="{{ url_for('main.courses') }}" class="btn btn-outline-primary btn-lg">
                            <i class="fas fa-graduation-cap me-2"></i>Explorar Cursos
                        </a>
                        {% endif %}
                    </div>
                </div>
            </div>
            
            <div class="col-lg-4">
                <div class="hero-stats slide-in">
                    <!-- Progress Card -->
                    <div class="progress-card mb-4">
                        <div class="d-flex justify-content-between align-items-center mb-3">
                            <h6 class="text-secondary-custom mb-0">Progresso do Missão</h6>
                            <i class="fas fa-target text-accent-green"></i>
                        </div>
                        <div class="progress-value mb-2">18</div>
                        <div class="progress-label">Dias decorridos</div>
                        <div class="progress-bar-container mt-3">
                            <div class="progress">
                                <div class="progress-bar" style="width: 65%"></div>
                            </div>
                        </div>
                    </div>

                    <!-- Quick Stats Grid -->
                    <div class="row g-3">
                        <div class="col-6">
                            <div class="stat-card">
                                <div class="stat-icon">
                                    <i class="fas fa-graduation-cap"></i>
                                </div>
                                <div class="stat-value">4</div>
                                <div class="stat-label">Cursos</div>
                            </div>
                        </div>
                        <div class="col-6">
                            <div class="stat-card">
                                <div class="stat-icon">
                                    <i class="fas fa-users"></i>
                                </div>
                                <div class="stat-value">1.2k</div>
                                <div class="stat-label">Alunos</div>
                            </div>
                        </div>
                        <div class="col-6">
                            <div class="stat-card">
                                <div class="stat-icon">
                                    <i class="fas fa-trophy"></i>
                                </div>
                                <div class="stat-value">95%</div>
                                <div class="stat-label">Aprovação</div>
                            </div>
                        </div>
                        <div class="col-6">
                            <div class="stat-card">
                                <div class="stat-icon">
                                    <i class="fas fa-star"></i>
                                </div>
                                <div class="stat-value">4.9</div>
                                <div class="stat-label">Avaliação</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Features Section -->
        <div class="row g-4 mt-5">
            <div class="col-md-4">
                <div class="feature-card">
                    <div class="feature-icon mb-3">
                        <i class="fas fa-gamepad fa-2x text-accent-green"></i>
                    </div>
                    <h5 class="text-primary-custom mb-3">Gamificação Militar</h5>
                    <p class="text-secondary-custom">
                        Sistema de níveis, conquistas e ranking que simula a hierarquia militar. 
                        Ganhe XP e suba de patente conforme avança nos estudos.
                    </p>
                </div>
            </div>
            <div class="col-md-4">
                <div class="feature-card">
                    <div class="feature-icon mb-3">
                        <i class="fas fa-chalkboard-teacher fa-2x text-accent-blue"></i>
                    </div>
                    <h5 class="text-primary-custom mb-3">Professores Especialistas</h5>
                    <p class="text-secondary-custom">
                        Instrutores com experiência militar e aprovação em concursos da Marinha. 
                        Metodologia focada nas provas de Cabo e Sargento.
                    </p>
                </div>
            </div>
            <div class="col-md-4">
                <div class="feature-card">
                    <div class="feature-icon mb-3">
                        <i class="fas fa-comments fa-2x text-accent-orange"></i>
                    </div>
                    <h5 class="text-primary-custom mb-3">Comunidade Ativa</h5>
                    <p class="text-secondary-custom">
                        Fórum exclusivo para troca de experiências, dúvidas e estratégias 
                        entre militares em preparação.
                    </p>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Features Section -->
<section class="features-section py-5">
    <div class="container">
        <div class="row text-center mb-5">
            <div class="col">
                <h2 class="display-5 text-white mb-3">
                    Por que escolher a <span class="text-gold">Academia Naval</span>?
                </h2>
                <p class="lead text-light-gray">
                    Nossa metodologia única combina excelência acadêmica com gamificação
                </p>
            </div>
        </div>
        
        <div class="row g-4">
            <div class="col-md-4">
                <div class="feature-card military-card text-center h-100">
                    <div class="feature-icon mb-3">
                        <i class="fas fa-medal fa-3x text-gold"></i>
                    </div>
                    <h4 class="text-white mb-3">Sistema de Gamificação</h4>
                    <p class="text-light-gray">
                        Progrida de Recruta a Almirante! Ganhe XP, conquiste badges douradas 
                        e acompanhe sua evolução no ranking militar.
                    </p>
                </div>
            </div>
            
            <div class="col-md-4">
                <div class="feature-card military-card text-center h-100">
                    <div class="feature-icon mb-3">
                        <i class="fas fa-chalkboard-teacher fa-3x text-gold"></i>
                    </div>
                    <h4 class="text-white mb-3">Professores Especialistas</h4>
                    <p class="text-light-gray">
                        Conteúdo desenvolvido por militares aprovados e professores 
                        com vasta experiência em concursos da Marinha.
                    </p>
                </div>
            </div>
            
            <div class="col-md-4">
                <div class="feature-card military-card text-center h-100">
                    <div class="feature-icon mb-3">
                        <i class="fas fa-mobile-alt fa-3x text-gold"></i>
                    </div>
                    <h4 class="text-white mb-3">Estude Onde Quiser</h4>
                    <p class="text-light-gray">
                        Plataforma responsiva e otimizada. Acesse seus cursos no computador, 
                        tablet ou celular, a qualquer hora.
                    </p>
                </div>
            </div>
            
            <div class="col-md-4">
                <div class="feature-card military-card text-center h-100">
                    <div class="feature-icon mb-3">
                        <i class="fas fa-stopwatch fa-3x text-gold"></i>
                    </div>
                    <h4 class="text-white mb-3">Simulados Cronometrados</h4>
                    <p class="text-light-gray">
                        Prepare-se com simulados que reproduzem as condições reais das provas, 
                        com tempo limitado e correção automática.
                    </p>
                </div>
            </div>
            
            <div class="col-md-4">
                <div class="feature-card military-card text-center h-100">
                    <div class="feature-icon mb-3">
                        <i class="fas fa-comments fa-3x text-gold"></i>
                    </div>
                    <h4 class="text-white mb-3">Comunidade Ativa</h4>
                    <p class="text-light-gray">
                        Interaja com outros candidatos no fórum, tire dúvidas com professores 
                        e compartilhe estratégias de estudo.
                    </p>
                </div>
            </div>
            
            <div class="col-md-4">
                <div class="feature-card military-card text-center h-100">
                    <div class="feature-icon mb-3">
                        <i class="fas fa-credit-card fa-3x text-gold"></i>
                    </div>
                    <h4 class="text-white mb-3">Pagamento Instantâneo</h4>
                    <p class="text-light-gray">
                        Ativação imediata via PIX. Pague e comece a estudar na mesma hora, 
                        com total segurança e praticidade.
                    </p>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- Courses Preview -->
<section class="courses-preview py-5">
    <div class="container">
        <div class="row align-items-center mb-5">
            <div class="col">
                <h2 class="display-5 text-white mb-3">
                    Cursos em <span class="text-gold">Destaque</span>
                </h2>
                <p class="lead text-light-gray">
                    Prepare-se com nossos cursos mais procurados
                </p>
            </div>
            <div class="col-auto">
                <a href="{{ url_for('main.courses') }}" class="btn btn-outline-gold">
                    Ver Todos os Cursos <i class="fas fa-arrow-right ms-2"></i>
                </a>
            </div>
        </div>
        
        <div class="row g-4">
            {% for course in courses[:3] %}
            <div class="col-md-4">
                <div class="course-card military-card h-100">
                    <div class="course-header">
                        <div class="course-category badge bg-military-red mb-2">
                            {{ course.category.title() }}
                        </div>
                        <h5 class="text-white">{{ course.title }}</h5>
                        <p class="text-light-gray small">{{ course.description[:100] }}...</p>
                    </div>
                    
                    <div class="course-meta mb-3">
                        <div class="row text-center">
                            <div class="col-4">
                                <small class="text-light-gray">Duração</small>
                                <div class="text-gold">{{ course.duration_hours }}h</div>
                            </div>
                            <div class="col-4">
                                <small class="text-light-gray">Nível</small>
                                <div class="text-gold">{{ course.level.title() }}</div>
                            </div>
                            <div class="col-4">
                                <small class="text-light-gray">Preço</small>
                                <div class="text-gold">R$ {{ "%.2f"|format(course.price) }}</div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="course-actions mt-auto">
                        <a href="{{ url_for('main.course_detail', course_id=course.id) }}" 
                           class="btn btn-outline-gold w-100">
                            <i class="fas fa-info-circle me-2"></i>Ver Detalhes
                        </a>
                    </div>
                </div>
            </div>
            {% endfor %}
        </div>
    </div>
</section>

<!-- Call to Action -->
<section class="cta-section py-5">
    <div class="container">
        <div class="row justify-content-center text-center">
            <div class="col-lg-8">
                <div class="cta-content military-card">
                    <h2 class="display-6 text-white mb-3">
                        Pronto para sua <span class="text-gold">Missão</span>?
                    </h2>
                    <p class="lead text-light-gray mb-4">
                        Junte-se a milhares de fuzileiros que já conquistaram suas aprovações. 
                        Sua carreira militar começa agora!
                    </p>
                    
                    {% if not current_user.is_authenticated %}
                    <div class="cta-actions">
                        <a href="{{ url_for('auth.register') }}" class="btn btn-gold btn-lg me-3">
                            <i class="fas fa-rocket me-2"></i>Começar Agora
                        </a>
                        <a href="{{ url_for('main.courses') }}" class="btn btn-outline-light btn-lg">
                            <i class="fas fa-search me-2"></i>Explorar Primeiro
                        </a>
                    </div>
                    {% else %}
                    <div class="welcome-back">
                        <h4 class="text-gold mb-3">Bem-vindo de volta, {{ current_user.get_military_level() }} {{ current_user.username }}!</h4>
                        <a href="{{ url_for('main.dashboard') }}" class="btn btn-gold btn-lg">
                            <i class="fas fa-play me-2"></i>Continuar Treinamento
                        </a>
                    </div>
                    {% endif %}
                </div>
            </div>
        </div>
    </div>
</section>
{% endblock %}

{% block scripts %}
<script>
// Auto-refresh leaderboard every 30 seconds
{% if not current_user.is_authenticated %}
setInterval(function() {
    fetch('/api/leaderboard')
        .then(response => response.json())
        .then(data => {
            updateLeaderboard(data.slice(0, 5));
        })
        .catch(error => console.error('Error updating leaderboard:', error));
}, 30000);

function updateLeaderboard(users) {
    const container = document.querySelector('.leaderboard-list');
    if (!container) return;
    
    container.innerHTML = '';
    users.forEach((user, index) => {
        const item = document.createElement('div');
        item.className = 'leaderboard-item d-flex align-items-center mb-2';
        item.innerHTML = `
            <span class="rank-badge ${index < 3 ? 'rank-top' : ''}">${index + 1}</span>
            <div class="user-info flex-grow-1 ms-3">
                <div class="username">${user.username}</div>
                <div class="user-level small text-light-gray">${user.military_level}</div>
            </div>
            <div class="xp-badge">${user.xp} XP</div>
        `;
        container.appendChild(item);
    });
}
{% endif %}
</script>
{% endblock %}
